name: YouTube Shorts Auto (20/day)

on:
  schedule:
    - cron: "0 0 * * *"
  workflow_dispatch:

jobs:
  upload:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

- name: Install dependencies
  run: |
    pip uninstall -y pillow
    pip install pillow==9.5.0
    pip install moviepy==1.0.3
    pip install gtts imageio-ffmpeg google-api-python-client google-auth google-auth-oauthlib


      - name: Decode YouTube token
        run: |
          echo "${{ secrets.YOUTUBE_TOKEN_B64 }}" | base64 --decode > token.json

      - name: Upload 20 shorts with random spacing
        run: |
          for i in {1..20}
          do
            echo "Uploading short $i"
            bash run_once.sh
            sleep $((RANDOM % 2100 + 600))
          done
